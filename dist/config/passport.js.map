{"version":3,"sources":["../../Finance_api/config/passport.js"],"names":["LocalStrategy","require","Strategy","passport","serializeUser","user","done","id","deserializeUser","User","findById","err","use","usernameField","passwordField","email","password","findOne","message","comparePassword","isMatch","module","exports"],"mappings":";;;;AAAA;;AAEA;;AADA,IAAMA,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAAP,CAA0BC,QAAhD;;AAGA;AACAC,qBAASC,aAAT,CAAuB,UAACC,IAAD,EAAOC,IAAP,EAAgB;AACrCA,EAAAA,IAAI,CAAC,IAAD,EAAOD,IAAI,CAACE,EAAZ,CAAJ;AACD,CAFD,E,CAIA;;;AACAJ,qBAASK,eAAT,CAAyB,UAACD,EAAD,EAAKD,IAAL,EAAc;AAAEG,oBAAKC,QAAL,CAAcH,EAAd,EAAkB,UAACI,GAAD,EAAMN,IAAN,EAAe;AAAEC,IAAAA,IAAI,CAACK,GAAD,EAAMN,IAAN,CAAJ;AAAiB,GAApD;AAAuD,CAAhG,E,CAEA;;;AACAF,qBAASS,GAAT,CAAa,IAAIZ,aAAJ,CAAkB;AAC7Ba,EAAAA,aAAa,EAAE,OADc;AAE7BC,EAAAA,aAAa,EAAE;AAFc,CAAlB,EAGV,UAACC,KAAD,EAAQC,QAAR,EAAkBV,IAAlB,EAA2B;AAC5BG,oBAAKQ,OAAL,CAAa;AAAEF,IAAAA,KAAK,EAAEA;AAAT,GAAb,EAA+B,UAACJ,GAAD,EAAMN,IAAN,EAAe;AAC1C,QAAIM,GAAJ,EAAS,OAAOL,IAAI,CAACK,GAAD,CAAX;AACT,QAAI,CAACN,IAAL,EAAW,OAAOC,IAAI,CAAC,IAAD,EAAO,KAAP,EAAc;AAAEY,MAAAA,OAAO,EAAE;AAAX,KAAd,CAAX;AACXb,IAAAA,IAAI,CAACc,eAAL,CAAqBH,QAArB,EAA+B,UAACL,GAAD,EAAMS,OAAN,EAAkB;AAC7C,UAAIA,OAAJ,EAAa;AACT,eAAOd,IAAI,CAAC,IAAD,EAAOD,IAAP,CAAX;AACH,OAFD,MAEO;AACH,eAAOC,IAAI,CAAC,IAAD,EAAO,KAAP,EAAc;AAAEY,UAAAA,OAAO,EAAE;AAAX,SAAd,CAAX;AACH;AACJ,KAND;AAOH,GAVD;AAWD,CAfY,CAAb;;AAiBAG,MAAM,CAACC,OAAP,GAAiBnB,oBAAjB","sourcesContent":["import passport from 'passport';\r\nconst LocalStrategy = require('passport-local').Strategy;\r\nimport User from '../models/users';\r\n\r\n//Serialize user\r\npassport.serializeUser((user, done) => {\r\n  done(null, user.id)\r\n})\r\n\r\n//Deserialize user\r\npassport.deserializeUser((id, done) => { User.findById(id, (err, user) => { done(err, user) }) });\r\n\r\n//Local Strategy\r\npassport.use(new LocalStrategy({\r\n  usernameField: 'email',\r\n  passwordField: 'password',\r\n}, (email, password, done) => {\r\n  User.findOne({ email: email }, (err, user) => {\r\n      if (err) return done(err);\r\n      if (!user) return done(null, false, { message: 'Incorrect Username' });\r\n      user.comparePassword(password, (err, isMatch) => {\r\n          if (isMatch) {\r\n              return done(null, user);\r\n          } else {\r\n              return done(null, false, { message: 'Incorrect password.' });\r\n          }\r\n      })\r\n  })\r\n}))\r\n\r\nmodule.exports = passport;"],"file":"passport.js"}