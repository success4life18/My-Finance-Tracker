{"version":3,"sources":["../../Finance_api/routes/expenses.js"],"names":["router","express","Router","post","req","res","next","Date","prototype","getWeek","dt","getFullYear","Math","ceil","getDay","body","week","month","getMonth","year","user","id","amount","parseInt","Expenses","create","flash","redirect","updateOne","_id","expenseId","deleteOne","module","exports"],"mappings":";;;;;;;;AAAA;;AAEA;;AADA,IAAMA,MAAM,GAAGC,oBAAQC,MAAR,EAAf;;AAGA;AACAF,MAAM,CAACG,IAAP,CAAY,kBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAgC,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;;AAExBC,YAAAA,IAAI,CAACC,SAAL,CAAeC,OAAf,GAAyB,YAAY;AACjC,kBAAIC,EAAE,GAAG,IAAIH,IAAJ,CAAS,KAAKI,WAAL,EAAT,EAA6B,CAA7B,EAAgC,CAAhC,CAAT;AACA,qBAAOC,IAAI,CAACC,IAAL,CAAU,CAAE,CAAC,OAAOH,EAAR,IAAc,QAAf,GAA2BA,EAAE,CAACI,MAAH,EAA3B,GAAyC,CAA1C,IAA+C,CAAzD,CAAP;AACH,aAHD;;AAIAV,YAAAA,GAAG,CAACW,IAAJ,CAASC,IAAT,GAAgB,IAAIT,IAAJ,GAAWE,OAAX,EAAhB;AACAL,YAAAA,GAAG,CAACW,IAAJ,CAASE,KAAT,GAAiB,IAAIV,IAAJ,GAAWW,QAAX,EAAjB;AACAd,YAAAA,GAAG,CAACW,IAAJ,CAASI,IAAT,GAAgB,IAAIZ,IAAJ,GAAWI,WAAX,EAAhB;AACAP,YAAAA,GAAG,CAACW,IAAJ,CAASK,IAAT,GAAgBhB,GAAG,CAACgB,IAAJ,CAASC,EAAzB;AACAjB,YAAAA,GAAG,CAACW,IAAJ,CAASO,MAAT,GAAkBC,QAAQ,CAACnB,GAAG,CAACW,IAAJ,CAASO,MAAV,CAA1B;AAVwB;AAAA,mBAWlBE,qBAASC,MAAT,CAAgBrB,GAAG,CAACW,IAApB,CAXkB;;AAAA;AAYxBX,YAAAA,GAAG,CAACsB,KAAJ,CAAU,aAAV,EAAyB,sCAAzB;AAZwB,6CAajBrB,GAAG,CAACsB,QAAJ,CAAa,MAAb,CAbiB;;AAAA;AAAA;AAAA;AAexBrB,YAAAA,IAAI,aAAJ;;AAfwB;AAgB3B;;AAhB2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhC;;AAAA;AAAA;AAAA;AAAA,K,CAmBA;;AACAN,MAAM,CAACG,IAAP,CAAY,gBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,+BAA8B,kBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpBkB,qBAASI,SAAT,CAAmB;AAACC,cAAAA,GAAG,EAAEzB,GAAG,CAACW,IAAJ,CAASe;AAAf,aAAnB,EAA8C1B,GAAG,CAACW,IAAlD,CADoB;;AAAA;AAE1BX,YAAAA,GAAG,CAACsB,KAAJ,CAAU,aAAV,EAAyB,uCAAzB;AAF0B,8CAGnBrB,GAAG,CAACsB,QAAJ,CAAa,MAAb,CAHmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA9B;;AAAA;AAAA;AAAA;AAAA,K,CAMA;;AACA3B,MAAM,CAACG,IAAP,CAAY,kBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAgC,kBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACtBkB,qBAASO,SAAT,CAAmB;AAACF,cAAAA,GAAG,EAAEzB,GAAG,CAACW,IAAJ,CAASe;AAAf,aAAnB,CADsB;;AAAA;AAE5B1B,YAAAA,GAAG,CAACsB,KAAJ,CAAU,aAAV,EAAyB,uCAAzB;AAF4B,8CAGrBrB,GAAG,CAACsB,QAAJ,CAAa,MAAb,CAHqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhC;;AAAA;AAAA;AAAA;AAAA;AAMAK,MAAM,CAACC,OAAP,GAAiBjC,MAAjB","sourcesContent":["import express from 'express';\r\nconst router = express.Router();\r\nimport Expenses from '../models/expenses';\r\n\r\n// Create a new expenses\r\nrouter.post('/expenses/create', async (req, res, next) => {\r\n    try{\r\n        Date.prototype.getWeek = function () {\r\n            var dt = new Date(this.getFullYear(), 0, 1);\r\n            return Math.ceil((((this - dt) / 86400000) + dt.getDay() + 1) / 7);\r\n        };\r\n        req.body.week = new Date().getWeek();\r\n        req.body.month = new Date().getMonth();\r\n        req.body.year = new Date().getFullYear();\r\n        req.body.user = req.user.id;\r\n        req.body.amount = parseInt(req.body.amount);\r\n        await Expenses.create(req.body);\r\n        req.flash('success_msg', 'Record has been created successfully');\r\n        return res.redirect('back');\r\n    }catch(e){\r\n        next(e);\r\n    };\r\n});\r\n\r\n// Edit an expense\r\nrouter.post('/expenses/edit', async (req, res, next) => {\r\n    await Expenses.updateOne({_id: req.body.expenseId}, req.body);\r\n    req.flash('success_msg', 'Expense has been updated successfully');\r\n    return res.redirect('back');\r\n});\r\n\r\n// Delete an expense\r\nrouter.post('/expenses/delete', async (req, res, next) => {\r\n    await Expenses.deleteOne({_id: req.body.expenseId});\r\n    req.flash('success_msg', 'Expense has been deleted successfully');\r\n    return res.redirect('back');\r\n});\r\n\r\nmodule.exports = router;"],"file":"expenses.js"}